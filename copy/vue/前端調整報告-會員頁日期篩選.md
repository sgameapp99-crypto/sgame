# æœƒå“¡é æ—¥æœŸç¯©é¸ - å‰ç«¯èª¿æ•´å ±å‘Š

**æ—¥æœŸ**: 2025å¹´10æœˆ22æ—¥  
**ç‹€æ…‹**: âœ… **å·²å®Œæˆèª¿æ•´**

---

## ğŸ“‹ èª¿æ•´æ¦‚è¦

æ ¹æ“šå¾Œç«¯å›è¦†æ–‡ä»¶ `æœƒå“¡é æ—¥æœŸç¯©é¸-å¾Œç«¯å›è¦†.md`ï¼Œå‰ç«¯å·²å®Œæˆä»¥ä¸‹å¿…è¦èª¿æ•´ã€‚

---

## âœ… å·²å®Œæˆçš„èª¿æ•´

### 1. åƒæ•¸åç¨±ä¿®æ­£ï¼š`userId` â†’ `memberId`

#### å•é¡Œ
å¾Œç«¯ API ä½¿ç”¨ `memberId` ä½œç‚ºæŸ¥è©¢åƒæ•¸ï¼Œè€Œé `userId`ã€‚é€™æ˜¯ç‚ºäº†å€åˆ†ï¼š
- `userId`ï¼šç•¶å‰ç™»å…¥ç”¨æˆ¶ï¼ˆå¾ session/token ç²å–ï¼‰
- `memberId`ï¼šè¦æŸ¥è©¢çš„ç›®æ¨™æœƒå“¡ IDï¼ˆå¯èƒ½æ˜¯è‡ªå·±æˆ–å…¶ä»–æœƒå“¡ï¼‰

#### ä¿®æ”¹æ–‡ä»¶

##### 1.1 types/prediction.ts

**ä¿®æ”¹å…§å®¹**ï¼š
```typescript
export interface PredictionsQueryParams {
  memberId?: string | number; // å¾Œç«¯ä½¿ç”¨ memberId æŸ¥è©¢ç›®æ¨™æœƒå“¡çš„é æ¸¬
  userId?: string; // ä¿ç•™å‘å¾Œå…¼å®¹ï¼ˆå·²å»¢æ£„ï¼Œè«‹ä½¿ç”¨ memberIdï¼‰
  allianceId?: number;
  dateRange?: DateRange;
  gameMode?: GameMode;
  status?: PredictionStatus | 'all';
  page?: number;
  size?: number;
  startDate?: string; // é–‹å§‹æ—¥æœŸ (YYYY-MM-DD)
  endDate?: string; // çµæŸæ—¥æœŸ (YYYY-MM-DD)ï¼Œæœªè¨­ç½®æ™‚è¡¨ç¤ºä¸é™çµæŸæ—¥æœŸ
}
```

**èªªæ˜**ï¼š
- æ–°å¢ `memberId` ä½œç‚ºä¸»è¦åƒæ•¸
- ä¿ç•™ `userId` ä»¥ç¶­æŒå‘å¾Œå…¼å®¹æ€§ï¼ˆæ¨™è¨˜ç‚ºå·²å»¢æ£„ï¼‰
- `memberId` æ”¯æ´ `string` æˆ– `number` é¡å‹

##### 1.2 MemberPage.vue

**ä¿®æ”¹ä½ç½®**ï¼šç¬¬712-720è¡Œ

**ä¿®æ”¹å‰**ï¼š
```typescript
const result = await predictionsAPI.getPredictions({
  userId: userId,
  page: currentPage.value,
  size: pageSize.value,
  startDate: startDate,
  endDate: endDate,
});
```

**ä¿®æ”¹å¾Œ**ï¼š
```typescript
// çµ±ä¸€ä½¿ç”¨ getPredictions APIï¼Œå‚³å…¥æ—¥æœŸç¯„åœåƒæ•¸
// æ³¨æ„ï¼šå¾Œç«¯ä½¿ç”¨ memberId è€Œé userId
const result = await predictionsAPI.getPredictions({
  memberId: userId, // å¾Œç«¯è¦æ±‚ä½¿ç”¨ memberId åƒæ•¸
  page: currentPage.value,
  size: pageSize.value,
  startDate: startDate,
  endDate: endDate,  // å¯èƒ½ç‚º undefined
});
```

---

## ğŸ“Š API èª¿ç”¨ç¯„ä¾‹

### å ´æ™¯ 1ï¼šæŸ¥è©¢ä¸€é€±å…§çš„é æ¸¬

```typescript
const result = await predictionsAPI.getPredictions({
  memberId: currentUser.id,  // ä½¿ç”¨ memberId
  startDate: '2025-10-22',
  endDate: '2025-10-29',
  page: 1,
  size: 20
});
```

**å°æ‡‰çš„ HTTP è«‹æ±‚**ï¼š
```http
GET /api/predictions?memberId=123&startDate=2025-10-22&endDate=2025-10-29&page=1&size=20
```

### å ´æ™¯ 2ï¼šæŸ¥è©¢ä¸€å€‹æœˆå…§çš„é æ¸¬

```typescript
const result = await predictionsAPI.getPredictions({
  memberId: currentUser.id,
  startDate: '2025-10-22',
  endDate: '2025-11-21',
  page: 1,
  size: 20
});
```

### å ´æ™¯ 3ï¼šæŸ¥è©¢å…¨éƒ¨æœªä¾†é æ¸¬ï¼ˆé‡è¦ï¼‰

```typescript
const result = await predictionsAPI.getPredictions({
  memberId: currentUser.id,
  startDate: '2025-10-22',
  // ä¸å‚³ endDateï¼Œå¾Œç«¯æœƒè¿”å›æ‰€æœ‰æœªä¾†é æ¸¬
  page: 1,
  size: 20
});
```

**å°æ‡‰çš„ HTTP è«‹æ±‚**ï¼š
```http
GET /api/predictions?memberId=123&startDate=2025-10-22&page=1&size=20
```

### å ´æ™¯ 4ï¼šçµåˆè¯ç›Ÿç¯©é¸

```typescript
const result = await predictionsAPI.getPredictions({
  memberId: currentUser.id,
  allianceId: 1, // MLB
  startDate: '2025-10-22',
  endDate: '2025-10-29',
  page: 1,
  size: 20
});
```

---

## ğŸ” éŒ¯èª¤è™•ç†

æ ¹æ“šå¾Œç«¯æä¾›çš„éŒ¯èª¤ç¢¼ï¼Œå‰ç«¯å·²æº–å‚™å¥½è™•ç†ä»¥ä¸‹éŒ¯èª¤ï¼š

### 1. æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼ˆHTTP 400ï¼‰

**å¾Œç«¯å›æ‡‰**ï¼š
```json
{
  "success": false,
  "message": "é–‹å§‹æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨ YYYY-MM-DD æ ¼å¼",
  "code": "INVALID_DATE_FORMAT"
}
```

**å‰ç«¯è™•ç†**ï¼š
```typescript
if (!response.success) {
  if (response.code === 'INVALID_DATE_FORMAT') {
    showError('æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨æ­£ç¢ºçš„æ—¥æœŸæ ¼å¼');
  }
}
```

### 2. æ—¥æœŸç¯„åœéŒ¯èª¤ï¼ˆHTTP 400ï¼‰

**å¾Œç«¯å›æ‡‰**ï¼š
```json
{
  "success": false,
  "message": "é–‹å§‹æ—¥æœŸä¸èƒ½å¤§æ–¼çµæŸæ—¥æœŸ",
  "code": "INVALID_DATE_RANGE"
}
```

**å‰ç«¯è™•ç†**ï¼š
```typescript
if (response.code === 'INVALID_DATE_RANGE') {
  showError('é–‹å§‹æ—¥æœŸä¸èƒ½å¤§æ–¼çµæŸæ—¥æœŸ');
}
```

### 3. ç„¡æ•¸æ“šæƒ…æ³ï¼ˆHTTP 200ï¼‰

**å¾Œç«¯å›æ‡‰**ï¼š
```json
{
  "success": true,
  "data": [],
  "pagination": {
    "page": 1,
    "size": 20,
    "total": 0
  }
}
```

**å‰ç«¯è™•ç†**ï¼š
```typescript
if (result.success && result.data.length === 0) {
  // é¡¯ç¤ºã€Œæš«ç„¡é æ¸¬ã€çš„å‹å–„æç¤º
}
```

---

## âœ… èª¿æ•´ç¢ºèªæ¸…å–®

- [x] 1. æ›´æ–° `types/prediction.ts` ä¸­çš„ `PredictionsQueryParams` ä»‹é¢
- [x] 2. æ›´æ–° `MemberPage.vue` ä¸­çš„ API èª¿ç”¨ï¼Œä½¿ç”¨ `memberId` è€Œé `userId`
- [x] 3. ç¢ºèªæ²’æœ‰å…¶ä»–åœ°æ–¹ä½¿ç”¨èˆŠçš„ `userId` åƒæ•¸
- [x] 4. é€šé TypeScript æª¢æŸ¥ï¼ˆç„¡ linter éŒ¯èª¤ï¼‰
- [x] 5. ä¿ç•™ `userId` æ¬„ä½ä»¥ç¶­æŒå‘å¾Œå…¼å®¹æ€§

---

## ğŸ§ª æ¸¬è©¦å»ºè­°

### å‰ç«¯æ¸¬è©¦é …ç›®

1. **ä¸€é€±å…§ç¯©é¸**
   - é¸æ“‡ã€Œä¸€é€±å…§ã€é¸é …
   - ç¢ºèªåªé¡¯ç¤ºä»Šå¤©åˆ°æœªä¾†7å¤©çš„é æ¸¬
   - æª¢æŸ¥ API è«‹æ±‚åƒæ•¸æ˜¯å¦æ­£ç¢ºå‚³é `memberId`, `startDate`, `endDate`

2. **ä¸€å€‹æœˆå…§ç¯©é¸**
   - é¸æ“‡ã€Œä¸€å€‹æœˆå…§ã€é¸é …
   - ç¢ºèªåªé¡¯ç¤ºä»Šå¤©åˆ°æœªä¾†30å¤©çš„é æ¸¬

3. **å…¨éƒ¨ç¯©é¸ï¼ˆæœ€é‡è¦ï¼‰**
   - é¸æ“‡ã€Œå…¨éƒ¨ã€é¸é …
   - ç¢ºèªé¡¯ç¤ºä»Šå¤©åˆ°æœªä¾†æ‰€æœ‰é æ¸¬ï¼ˆä¸é™çµæŸæ—¥æœŸï¼‰
   - **ç¢ºèª API è«‹æ±‚ä¸­åªæœ‰ `startDate`ï¼Œæ²’æœ‰ `endDate`**

4. **è¯ç›Ÿç¯©é¸çµåˆæ—¥æœŸç¯©é¸**
   - é¸æ“‡ç‰¹å®šè¯ç›Ÿï¼ˆå¦‚ MLBï¼‰+ ä¸€é€±å…§
   - ç¢ºèªåŒæ™‚æ‡‰ç”¨å…©å€‹ç¯©é¸æ¢ä»¶

5. **åˆ†é åŠŸèƒ½**
   - ç¢ºèªç¿»é å¾Œåƒæ•¸ä»ç„¶æ­£ç¢º

6. **éŒ¯èª¤è™•ç†**
   - æ¨¡æ“¬å¾Œç«¯éŒ¯èª¤å›æ‡‰ï¼Œç¢ºèªå‰ç«¯é¡¯ç¤ºå‹å–„æç¤º

---

## ğŸ“ å¾Œç«¯ API ç«¯é»è³‡è¨Š

### æ¸¬è©¦ç’°å¢ƒ
```
URL: https://10.2.0.2:8080
ç«¯é»: GET /api/predictions
```

### æ¸¬è©¦å¸³è™Ÿ
```
Email: testpred@example.com
Password: Pred1234!@#
Member ID: 5
```

### æ¸¬è©¦ç”¨ curl æŒ‡ä»¤

```bash
# 1. ç™»å…¥ç²å– cookie
curl -k -c cookies.txt -X POST https://10.2.0.2:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"testpred@example.com","password":"Pred1234!@#"}'

# 2. æ¸¬è©¦ä¸€é€±å…§
curl -k -b cookies.txt "https://10.2.0.2:8080/api/predictions?memberId=5&startDate=2025-10-22&endDate=2025-10-29"

# 3. æ¸¬è©¦å…¨éƒ¨ï¼ˆä¸å‚³ endDateï¼‰
curl -k -b cookies.txt "https://10.2.0.2:8080/api/predictions?memberId=5&startDate=2025-10-22"
```

---

## ğŸ”„ èˆ‡å…¶ä»–åŠŸèƒ½çš„å…¼å®¹æ€§

### ä¸å—å½±éŸ¿çš„åŠŸèƒ½
- é æ¸¬é é¢ï¼ˆPredictPage.vueï¼‰- ä½¿ç”¨ä¸åŒçš„ç¯©é¸é‚è¼¯
- è³½äº‹é é¢ï¼ˆGamesBattlePage.vue, GamesStandingsPage.vueï¼‰
- å³æ™‚æ¯”åˆ†é é¢ï¼ˆLivescorePage.vueï¼‰

### å¯èƒ½éœ€è¦æ³¨æ„çš„åœ°æ–¹
å¦‚æœæœªä¾†å…¶ä»–é é¢ä¹Ÿéœ€è¦æŸ¥è©¢æœƒå“¡çš„é æ¸¬åˆ—è¡¨ï¼Œè«‹ç¢ºä¿ï¼š
1. ä½¿ç”¨ `memberId` è€Œé `userId`
2. åƒè€ƒ `MemberPage.vue` ä¸­çš„å¯¦ä½œæ–¹å¼

---

## ğŸ’¡ é¡å¤–å»ºè­°

### 1. æ—¥æœŸè¨ˆç®—å„ªåŒ–
ç›®å‰æ—¥æœŸè¨ˆç®—åœ¨å‰ç«¯é€²è¡Œï¼Œå»ºè­°ä¿æŒé€™å€‹æ–¹å¼ï¼š
```typescript
// ä»Šå¤©
const today = new Date();
today.setHours(0, 0, 0, 0);
const startDate = today.toISOString().split('T')[0];

// ä¸€é€±å¾Œ
const weekLater = new Date(today);
weekLater.setDate(weekLater.getDate() + 7);
const endDate = weekLater.toISOString().split('T')[0];
```

### 2. é è¨­å€¼
- é è¨­é¸æ“‡ã€Œå…¨éƒ¨ã€ï¼š`selectedDateRange.value = 'all'`
- é è¨­ `startDate` ç‚ºä»Šå¤©
- é è¨­ä¸è¨­ç½® `endDate`

### 3. ä½¿ç”¨è€…é«”é©—
- åˆ‡æ›æ—¥æœŸç¯„åœæ™‚è‡ªå‹•é‡æ–°è¼‰å…¥é æ¸¬
- é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹ï¼ˆloading spinnerï¼‰
- ç„¡æ•¸æ“šæ™‚é¡¯ç¤ºå‹å–„æç¤º
- éŒ¯èª¤æ™‚é¡¯ç¤ºå…·é«”çš„éŒ¯èª¤è¨Šæ¯

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [æœƒå“¡é é æ¸¬APIéœ€æ±‚æ–‡ä»¶.md](./æœƒå“¡é é æ¸¬APIéœ€æ±‚æ–‡ä»¶.md) - å‰ç«¯æä¾›çµ¦å¾Œç«¯çš„éœ€æ±‚æ–‡ä»¶
- [æœƒå“¡é æ—¥æœŸç¯©é¸-å¾Œç«¯å›è¦†.md](../api/å‰ç«¯æ•´åˆæ–‡æª”1022/æœƒå“¡é æ—¥æœŸç¯©é¸-å¾Œç«¯å›è¦†.md) - å¾Œç«¯çš„å¯¦ä½œå›è¦†

---

## ğŸ“ è¯çµ¡è³‡è¨Š

**å‰ç«¯è² è²¬äºº**: [æ‚¨çš„åå­—]  
**å¾Œç«¯è² è²¬äºº**: å¾Œç«¯åœ˜éšŠ  
**æ–‡æª”ä½ç½®**: `/copy/vue/å‰ç«¯èª¿æ•´å ±å‘Š-æœƒå“¡é æ—¥æœŸç¯©é¸.md`

---

## ğŸ“Œ é‡è¦æé†’

### âš ï¸ é—œéµè®Šæ›´
**åƒæ•¸åç¨±å¾ `userId` æ”¹ç‚º `memberId`ï¼Œé€™æ˜¯ä¸å…¼å®¹çš„è®Šæ›´ã€‚**

æ‰€æœ‰èª¿ç”¨ `predictionsAPI.getPredictions()` ä¸”éœ€è¦æŸ¥è©¢ç‰¹å®šæœƒå“¡é æ¸¬çš„åœ°æ–¹ï¼Œéƒ½å¿…é ˆä½¿ç”¨ `memberId` åƒæ•¸ã€‚

### âœ… å‘å¾Œå…¼å®¹æ€§
ç‚ºäº†å®‰å…¨èµ·è¦‹ï¼Œæˆ‘å€‘åœ¨é¡å‹å®šç¾©ä¸­ä¿ç•™äº† `userId` æ¬„ä½ï¼Œä½†æ¨™è¨˜ç‚ºå·²å»¢æ£„ã€‚æœªä¾†æ‰€æœ‰æ–°ä»£ç¢¼æ‡‰ä½¿ç”¨ `memberId`ã€‚

---

**èª¿æ•´å®Œæˆæ—¥æœŸ**: 2025å¹´10æœˆ22æ—¥  
**æ–‡æª”ç‰ˆæœ¬**: v1.0  
**ç‹€æ…‹**: âœ… å·²å®Œæˆä¸¦å¯é€²è¡Œæ•´åˆæ¸¬è©¦


openapi: 3.1.0
info:
  title: SGame Member API
  version: 0.1.0
  description: |
    å‰å¾Œç«¯å”ä½œç”¨ API è¦æ ¼ï¼ˆå°å¤– REST + JSONï¼‰ã€‚
    - å°å¤–å‚³è¼¸æ ¼å¼ï¼šapplication/json
    - è¦æ ¼æ–‡ä»¶æ ¼å¼ï¼šOpenAPI (YAML)
servers:
  - url: https://10.2.0.2:8080
    description: Development (å…§ç¶²ç’°å¢ƒ)
  - url: https://api.example.com
    description: Production
  - url: https://staging-api.example.com
    description: Staging
tags:
  - name: system
    description: ç³»çµ±ç‹€æ…‹æª¢æŸ¥
  - name: auth
    description: èªè­‰
  - name: members
    description: æœƒå“¡è³‡æ–™/é é¢ä¸»é«”
  - name: me
    description: å€‹äººè¨­å®š/è³‡æ–™ç¶­è­·
  - name: filters
    description: ç¯©é¸/å­—å…¸è³‡æ–™
  - name: posts
    description: æœƒå“¡ç™¼æ–‡
  - name: levels
    description: æœƒå“¡ç­‰ç´šç³»çµ±
  - name: livescore
    description: å³æ™‚æ¯”åˆ†æŸ¥è©¢
  - name: games
    description: è³½äº‹ç®¡ç†èˆ‡çµ±è¨ˆ

paths:
  /health:
    get:
      tags: [system]
      summary: å¥åº·æª¢æŸ¥
      description: æª¢æŸ¥APIæœå‹™ã€è³‡æ–™åº«å’ŒRedisé€£æ¥ç‹€æ…‹
      responses:
        '200':
          description: æœå‹™æ­£å¸¸é‹è¡Œ
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "healthy"
                  timestamp:
                    type: string
                    format: date-time
                  services:
                    type: object
                    properties:
                      database:
                        type: string
                        example: "connected"
                      redis:
                        type: string
                        example: "connected"

  /levels:
    get:
      tags: [levels]
      summary: ç²å–æ‰€æœ‰ç­‰ç´šè³‡è¨Š
      responses:
        '200':
          description: ç­‰ç´šè³‡è¨Šåˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  levels:
                    type: array
                    items:
                      type: object
                      properties:
                        code:
                          type: string
                          example: "bronze"
                        name:
                          type: string
                          example: "é’éŠ…"
                        nameEn:
                          type: string
                          example: "Bronze"
                        color:
                          type: string
                          example: "#CD7F32"
                        icon:
                          type: string
                          example: "ğŸ¥‰"
                        minScore:
                          type: number
                          example: 0
                        maxScore:
                          type: number
                          nullable: true
                          example: 999
                        description:
                          type: string
                          example: "æ–°æ‰‹ç­‰ç´š"
                        benefits:
                          type: array
                          items:
                            type: string
                          example: ["åŸºæœ¬æœƒå“¡åŠŸèƒ½", "æ¯æ—¥ç™»å…¥çå‹µ"]

  /levels/stats:
    get:
      tags: [levels]
      summary: ç²å–ç­‰ç´šçµ±è¨ˆè³‡è¨Š
      responses:
        '200':
          description: ç­‰ç´šçµ±è¨ˆ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  stats:
                    type: object

  /auth/login:
    post:
      tags: [auth]
      summary: ä½¿ç”¨è€…ç™»å…¥
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
              required: [email, password]
      responses:
        '200':
          description: ç™»å…¥æˆåŠŸï¼ˆåŒæ™‚ä»¥ Set-Cookie ä¸‹ç™¼ HttpOnly æœƒè©±ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ç™»å…¥æˆåŠŸ"
                  token:
                    type: string
                    description: JWT Bearer Token
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  passwordExpiry:
                    $ref: '#/components/schemas/PasswordExpiryInfo'
        '204':
          description: ç™»å…¥æˆåŠŸï¼ˆç„¡å›æ‡‰å…§å®¹ï¼›ä»¥ Set-Cookie ä¸‹ç™¼ HttpOnly æœƒè©±ï¼‰
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/register:
    post:
      tags: [auth]
      summary: ä½¿ç”¨è€…è¨»å†Šï¼ˆEmail/Passwordï¼‰
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
                name:
                  type: string
              required: [email, password, name]
      responses:
        '201':
          description: è¨»å†ŠæˆåŠŸï¼ˆéœ€è¦éƒµç®±é©—è­‰ï¼‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    description: è¨»å†ŠæˆåŠŸè¨Šæ¯
                    example: "è¨»å†ŠæˆåŠŸï¼Œè«‹æª¢æŸ¥éƒµç®±ä¸¦å®Œæˆé©—è­‰"
                  redirectUrl:
                    type: string
                    description: è¨»å†Šå¾Œå°å›è·¯å¾‘
                    example: "/login"
                  needsVerification:
                    type: boolean
                    description: æ˜¯å¦éœ€è¦éƒµç®±é©—è­‰
                    default: true
                    example: true
        '409':
          description: Email å·²è¢«ä½¿ç”¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/ErrorResponse'
                  - $ref: '#/components/schemas/PasswordWeakError'

  /auth/send-verification:
    post:
      tags: [auth]
      summary: ç™¼é€éƒµç®±é©—è­‰ç¢¼
      description: å‘ç”¨æˆ¶éƒµç®±ç™¼é€ 6 ä½æ•¸é©—è­‰ç¢¼
      security:
        - bearerAuth: []
      responses:
        '200':
          description: é©—è­‰ç¢¼ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '400':
          description: ç™¼é€å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/verify-email:
    post:
      tags: [auth]
      summary: é©—è­‰éƒµç®±é©—è­‰ç¢¼
      description: ä½¿ç”¨ 6 ä½æ•¸é©—è­‰ç¢¼é©—è­‰ç”¨æˆ¶éƒµç®±
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  pattern: '^[0-9]{6}$'
                  description: 6ä½æ•¸é©—è­‰ç¢¼
              required: [code]
      responses:
        '200':
          description: é©—è­‰æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationResponse'
        '400':
          description: é©—è­‰å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailVerificationError'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # Note: /auth/resend-verification endpoint has been removed
  # Use /auth/send-verification for both initial send and resend
  # The service automatically handles cooldown periods (60 seconds)

  /auth/verification-status:
    get:
      tags: [auth]
      summary: æª¢æŸ¥é©—è­‰ç‹€æ…‹
      description: ç²å–ç”¨æˆ¶éƒµç®±é©—è­‰ç‹€æ…‹
      security:
        - bearerAuth: []
      responses:
        '200':
          description: ç²å–é©—è­‰ç‹€æ…‹æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/forgot-password:
    post:
      tags: [auth]
      summary: å¿˜è¨˜å¯†ç¢¼ - ç™¼é€é‡è¨­éƒµä»¶
      description: å‘ç”¨æˆ¶éƒµç®±ç™¼é€å¯†ç¢¼é‡è¨­éƒµä»¶
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  description: ç”¨æˆ¶éƒµç®±
              required: [email]
      responses:
        '200':
          description: é‡è¨­éƒµä»¶ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '400':
          description: ç™¼é€å¤±æ•—æˆ–å¸³è™Ÿå•é¡Œ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/verify-reset-token:
    post:
      tags: [auth]
      summary: é©—è­‰å¯†ç¢¼é‡è¨­ä»¤ç‰Œ
      description: é©—è­‰å¾éƒµä»¶ä¸­ç²å¾—çš„é‡è¨­ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  description: é‡è¨­ä»¤ç‰Œ
              required: [token]
      responses:
        '200':
          description: ä»¤ç‰Œé©—è­‰çµæœ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenVerificationResponse'
        '400':
          description: ä»¤ç‰Œç„¡æ•ˆæˆ–å·²éæœŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenVerificationResponse'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/reset-password:
    post:
      tags: [auth]
      summary: é‡è¨­å¯†ç¢¼
      description: ä½¿ç”¨é‡è¨­ä»¤ç‰Œè¨­å®šæ–°å¯†ç¢¼
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  description: é‡è¨­ä»¤ç‰Œ
                newPassword:
                  type: string
                  minLength: 8
                  description: æ–°å¯†ç¢¼
              required: [token, newPassword]
      responses:
        '200':
          description: å¯†ç¢¼é‡è¨­æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '400':
          description: ä»¤ç‰Œç„¡æ•ˆæˆ–å¯†ç¢¼ä¸ç¬¦åˆè¦æ±‚
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/PasswordResetResponse'
                  - $ref: '#/components/schemas/PasswordWeakError'
        '422':
          description: åƒæ•¸é©—è­‰éŒ¯èª¤
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/ErrorResponse'
                  - $ref: '#/components/schemas/PasswordWeakError'

  /auth/change-password:
    post:
      tags: [auth]
      summary: æ›´æ–°å¯†ç¢¼
      description: å·²ç™»å…¥ç”¨æˆ¶æ›´æ–°å¯†ç¢¼
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                currentPassword:
                  type: string
                  description: ç•¶å‰å¯†ç¢¼
                newPassword:
                  type: string
                  minLength: 8
                  description: æ–°å¯†ç¢¼
              required: [currentPassword, newPassword]
      responses:
        '200':
          description: å¯†ç¢¼æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordChangeResponse'
        '400':
          description: å¯†ç¢¼é©—è­‰å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '422':
          description: æ–°å¯†ç¢¼ä¸ç¬¦åˆè¦æ±‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordWeakError'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/password-expiry-status:
    get:
      tags: [auth]
      summary: æª¢æŸ¥å¯†ç¢¼éæœŸç‹€æ…‹
      description: ç²å–ç”¨æˆ¶å¯†ç¢¼éæœŸç‹€æ…‹è³‡è¨Š
      security:
        - bearerAuth: []
      responses:
        '200':
          description: å¯†ç¢¼éæœŸç‹€æ…‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordExpiryStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /auth/oauth/google/start:
    get:
      tags: [auth]
      summary: Google OAuth ç™»å…¥èµ·å§‹ï¼ˆå°å‘ä¾›æ‡‰å•†æˆæ¬Šé ï¼‰
      parameters:
        - $ref: '#/components/parameters/RedirectUrl'
      responses:
        '302': { description: é‡æ–°å°å‘è‡³ Google æˆæ¬Šé  }

  /auth/oauth/google/callback:
    get:
      tags: [auth]
      summary: Google OAuth å›èª¿ï¼ˆäº¤æ›æˆæ¬Šç¢¼ã€å»ºç«‹æœƒè©±ï¼‰
      responses:
        '302': { description: å»ºç«‹æœƒè©±ä¸¦å°å› redirectUrl æˆ–å°å› /login é¡¯ç¤ºéŒ¯èª¤ }

  /auth/oauth/facebook/start:
    get:
      tags: [auth]
      summary: Facebook OAuth ç™»å…¥èµ·å§‹ï¼ˆå°å‘ä¾›æ‡‰å•†æˆæ¬Šé ï¼‰
      parameters:
        - $ref: '#/components/parameters/RedirectUrl'
      responses:
        '302': { description: é‡æ–°å°å‘è‡³ Facebook æˆæ¬Šé  }

  /auth/oauth/facebook/callback:
    get:
      tags: [auth]
      summary: Facebook OAuth å›èª¿ï¼ˆäº¤æ›æˆæ¬Šç¢¼ã€å»ºç«‹æœƒè©±ï¼‰
      responses:
        '302': { description: å»ºç«‹æœƒè©±ä¸¦å°å› redirectUrl æˆ–å°å› /login é¡¯ç¤ºéŒ¯èª¤ }

  /auth/logout:
    post:
      tags: [auth]
      summary: ç™»å‡º
      responses:
        '204':
          description: å·²ç™»å‡º

  /auth/session:
    get:
      tags: [auth]
      summary: æŸ¥è©¢ç›®å‰ Session/Token æœ‰æ•ˆæ€§
      responses:
        '200':
          description: Session æœ‰æ•ˆ
          content:
            application/json:
              schema:
                type: object
                properties:
                  loggedIn:
                    type: boolean
                    example: true
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                        format: email
                      name:
                        type: string
        '401':
          description: æœªç™»å…¥æˆ–Sessionç„¡æ•ˆ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "æœªç™»å…¥"
                  loggedIn:
                    type: boolean
                    example: false

  /users/profile:
    get:
      tags: [users]
      summary: å–å¾—ä½¿ç”¨è€…å€‹äººè³‡æ–™ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      security:
        - bearerAuth: []
        - cookieAuth: []
      responses:
        '200': { description: ç”¨æˆ¶è³‡æ–™ }
        '401': { $ref: '#/components/responses/Unauthorized' }
    put:
      tags: [users]
      summary: æ›´æ–°ä½¿ç”¨è€…å€‹äººè³‡æ–™ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      security:
        - bearerAuth: []
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                phone:
                  type: string
                avatar:
                  type: string
      responses:
        '200': { description: æ›´æ–°æˆåŠŸ }
        '401': { $ref: '#/components/responses/Unauthorized' }

  /api/predictions:
    get:
      tags: [predictions]
      summary: å–å¾—é æ¸¬åˆ—è¡¨
      description: |
        ä¾æŸ¥è©¢æ¢ä»¶åˆ—å‡ºé æ¸¬å¡ç‰‡ã€‚æœªç™»å…¥ä¹Ÿèƒ½ç€è¦½å…¬é–‹é æ¸¬ï¼Œè‹¥å¸¶å…¥è‡ªå·±çš„ `memberId`
        ä¸¦æä¾›æœ‰æ•ˆ Session/JWTï¼Œæœƒè‡ªå‹•é¡¯ç¤ºå®Œæ•´å…§å®¹ï¼ˆselection/noteï¼‰èˆ‡è³¼è²·ç‹€æ…‹ã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
        - {}
      parameters:
        - in: query
          name: memberId
          schema:
            type: integer
          required: false
          description: æŒ‡å®šæœƒå“¡ IDï¼›è‹¥ç‚ºè‡ªå·±ä¸”å·²ç™»å…¥å‰‡æœƒå®Œæ•´é¡¯ç¤ºå…§å®¹ã€‚
        - in: query
          name: status
          schema:
            type: string
            enum: [pending, win, lose, cancelled, all]
            default: all
          required: false
          description: é æ¸¬ç‹€æ…‹ï¼Œ`all` è¡¨ç¤ºä¸ç¯©é¸ã€‚
        - in: query
          name: allianceId
          schema:
            type: integer
          required: false
          description: è¯ç›Ÿ IDï¼Œå°æ‡‰ `games.allianceId`ã€‚
        - in: query
          name: startDate
          schema:
            type: string
            format: date
          required: false
          description: è³½äº‹æ—¥æœŸï¼ˆå«ï¼‰èµ·å§‹ï¼Œæ ¼å¼ `YYYY-MM-DD`ï¼Œå…è¨±æ—©æ–¼ä»Šæ—¥ä»¥æŸ¥è©¢æ­·å²æˆ°ç¸¾ã€‚
        - in: query
          name: endDate
          schema:
            type: string
            format: date
          required: false
          description: è³½äº‹æ—¥æœŸï¼ˆå«ï¼‰çµæŸï¼Œæ ¼å¼ `YYYY-MM-DD`ã€‚
        - in: query
          name: dateRange
          schema:
            type: string
            enum: [today, week, month, past7, past30, all]
          required: false
          description: ç¯„åœå¿«æ·ï¼Œåƒ…åœ¨æœªå¸¶ `startDate/endDate` æ™‚ç”Ÿæ•ˆï¼›`past7/past30` æœƒå›å‚³éå»å€é–“ã€‚
        - in: query
          name: gameMode
          schema:
            type: string
            enum: [international, taiwan, all]
          required: false
          description: ç›¤å£åˆ†é¡ï¼Œæœƒæ¯”å° `predictionType` å‰ç¶´ã€‚
        - in: query
          name: isFeatured
          schema:
            type: boolean
          required: false
          description: `true` åªåˆ—å‡ºä¸»æ¨ï¼Œ`false` åƒ…åˆ—å‡ºéä¸»æ¨ï¼Œçœç•¥å‰‡ä¸ç¯©é¸ã€‚
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [createdAt, settledAt, featuredAt]
            default: settledAt
          required: false
          description: æ’åºæ¬„ä½ï¼Œé è¨­ä¾çµç®—æ™‚é–“ï¼ˆsettledAtï¼‰ç”±æ–°åˆ°èˆŠï¼Œäº¦å¯æŒ‡å®š featuredAtã€‚
        - in: query
          name: order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          required: false
          description: æ’åºæ–¹å‘ï¼Œé è¨­ `desc`ã€‚
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          required: false
          description: åˆ†é é ç¢¼ã€‚
        - in: query
          name: size
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
          required: false
          description: æ¯é ç­†æ•¸ã€‚
      responses:
        '200':
          description: æˆåŠŸå›å‚³é æ¸¬åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredictionListResponse'
              examples:
                æˆ‘çš„é æ¸¬:
                  value:
                    success: true
                    data:
                      - id: 402
                        userId: 3
                        userName: "ç‹ç‰Œé«˜æ‰‹"
                        userAvatarUrl: "https://api.sportspro.tw/uploads/avatars/3.png"
                        gameId: "MLB20251113001"
                        gameInfo:
                          allianceId: 2
                          allianceName: "MLB"
                          sportType: "baseball"
                          status: "scheduled"
                          gameDate: "2025-11-13"
                          gameTime: "19:05"
                          homeTeam: "SF Giants"
                          awayTeam: "HOU Astros"
                          finalScore: null
                        predictionType: "international_spread"
                        predictionTypeLabel: "åœ‹éš›ç›¤è®“åˆ†"
                        selection: "home"
                        selectionLabel: "ä¸»éšŠ -1.5"
                        odds: "1.92"
                        price: 50
                        isMainPick: true
                        isFeatured: true
                        featuredAt: "2025-11-12T10:05:11.102Z"
                        featuredBy: 3
                        featuredNote: "ä»Šæ—¥ä¸»æ¨"
                        note: "ç‰›æ£šåå¼±ï¼Œä»çœ‹ä¸»éšŠéç›¤"
                        status: "pending"
                        isPurchased: true
                        isOwn: true
                        createdAt: "2025-11-13T10:05:11.102Z"
                        updatedAt: "2025-11-13T10:05:11.102Z"
                        settledAt: "2025-11-13T14:10:00.000Z"
                    pagination:
                      page: 1
                      size: 20
                      total: 4
                      totalPages: 1
                      hasNext: false
        '400':
          description: åƒæ•¸éŒ¯èª¤ï¼ˆæ—¥æœŸæ ¼å¼æˆ–ç¯„åœï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
    post:
      tags: [predictions]
      summary: å»ºç«‹é æ¸¬
      description: ç”±æœƒå“¡åœ¨è³½äº‹é–‹æ‰“å‰å»ºç«‹æ–°é æ¸¬ï¼Œåƒ…å…è¨±å°å°šæœªé–‹å§‹çš„è³½äº‹ä½¿ç”¨ä¸€æ¬¡ç›¸åŒç›¤å£ã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [gameId, predictionType, selection, odds]
              properties:
                gameId:
                  type: string
                  description: è³½äº‹ IDï¼Œå°æ‡‰ `games.id`ã€‚
                predictionType:
                  type: string
                  description: ç›¤å£ä»£ç¢¼ï¼ˆå¦‚ `international_spread`ã€`taiwan_total`ï¼‰ã€‚
                selection:
                  type: string
                  description: é¸æ“‡ä»£ç¢¼ï¼ˆhome/away/over/under... ä¾ç›¤å£ä¸åŒï¼‰ã€‚
                odds:
                  type: string
                  description: ç•¶ä¸‹è³ ç‡ï¼ˆå­—ä¸²å½¢å¼ä¿å­˜å°æ•¸ï¼‰ã€‚
                price:
                  type: integer
                  minimum: 0
                  maximum: 10000
                  default: 0
                  description: å”®åƒ¹ï¼ˆå½©å¹£ï¼‰ï¼Œ0 ä»£è¡¨å…è²»ã€‚
                isMainPick:
                  type: boolean
                  default: false
                  description: æ˜¯å¦ç‚ºä¸»æ¨ã€‚
                note:
                  type: string
                  nullable: true
                  description: è£œå……èªªæ˜ï¼Œåƒ…é¡¯ç¤ºçµ¦è³¼è²·è€…æˆ–ä½œè€…æœ¬äººã€‚
      responses:
        '201':
          description: é æ¸¬å»ºç«‹æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  predictionId:
                    type: integer
              examples:
                created:
                  value:
                    success: true
                    message: "é æ¸¬å·²å»ºç«‹"
                    predictionId: 402
        '400':
          description: åƒæ•¸éŒ¯èª¤æˆ–è³½äº‹å·²é–‹å§‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: æ‰¾ä¸åˆ°è³½äº‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: åŒé¡å‹é æ¸¬å·²å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/predictions/{id}:
    get:
      tags: [predictions]
      summary: å–å¾—ç‰¹å®šé æ¸¬è©³æƒ…
      description: |
        å–å¾—å–®ç­†é æ¸¬è³‡æ–™ã€‚æœªè³¼è²·è€…åƒ…èƒ½çœ‹åˆ°å…¬é–‹æ¬„ä½ï¼›è‹¥ç‚ºä½œè€…æœ¬äººæˆ–å·²è³¼è²·è€…ï¼Œ
        æœƒä¸€ä½µè¿”å› selection/noteã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
        - {}
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200':
          description: é æ¸¬è©³æƒ…
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/PredictionListItem'
              examples:
                purchased:
                  value:
                    success: true
                    data:
                      id: 402
                      userId: 3
                      userName: "ç‹ç‰Œé«˜æ‰‹"
                      userAvatarUrl: "https://api.sportspro.tw/uploads/avatars/3.png"
                      gameId: "MLB20251113001"
                      gameInfo:
                        allianceId: 2
                        allianceName: "MLB"
                        sportType: "baseball"
                        gameDate: "2025-11-13"
                        gameTime: "19:05"
                        homeTeam: "SF Giants"
                        awayTeam: "HOU Astros"
                        finalScore: null
                      predictionType: "international_spread"
                      predictionTypeLabel: "åœ‹éš›ç›¤è®“åˆ†"
                      selection: "home"
                      selectionLabel: "ä¸»éšŠ -1.5"
                      odds: "1.92"
                      price: 50
                      isMainPick: true
                      note: "ç‰›æ£šåå¼±ï¼Œä»çœ‹ä¸»éšŠéç›¤"
                      status: "pending"
                      isPurchased: true
                      isOwn: true
                      createdAt: "2025-11-13T10:05:11.102Z"
                      updatedAt: "2025-11-13T10:05:11.102Z"
        '404':
          description: é æ¸¬ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/predictions/{id}/feature:
    post:
      tags: [predictions]
      summary: è¨­å®šé æ¸¬ç‚ºä¸»æ¨
      description: |
        åƒ…é æ¸¬ä½œè€…æˆ–å…·å‚™ç®¡ç†æ¬Šé™çš„å¸³è™Ÿå¯è¨­å®šä¸»æ¨ã€‚è‹¥è©²æœƒå“¡å·²æœ‰å…¶ä»–ä¸»æ¨ï¼Œ
        å°‡è‡ªå‹•å–æ¶ˆèˆŠä¸»æ¨ã€æ›´æ–° `featuredAt/featuredBy` èˆ‡å‚™è¨»ã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                note:
                  type: string
                  maxLength: 200
                  description: ä¸»æ¨å‚™è¨»ï¼Œå¯é¡¯ç¤ºåœ¨å‰ç«¯å¡ç‰‡ä¸Šã€‚
      responses:
        '200':
          description: ä¸»æ¨è¨­å®šæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean }
                  data:
                    $ref: '#/components/schemas/PredictionListItem'
        '400':
          description: é æ¸¬ä¸ç¬¦åˆä¸»æ¨æ¢ä»¶ï¼ˆå·²çµæŸ/å·²çµç®—ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: ç„¡æ¬Šé™è¨­å®šä¸»æ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/predictions/{id}/unfeature:
    post:
      tags: [predictions]
      summary: å–æ¶ˆä¸»æ¨
      security:
        - bearerAuth: []
        - cookieAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string }
      responses:
        '200':
          description: å·²å–æ¶ˆä¸»æ¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean }
                  data:
                    $ref: '#/components/schemas/PredictionListItem'
        '403':
          description: ç„¡æ¬Šé™æ“ä½œ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/predictions/feature-candidates:
    get:
      tags: [predictions]
      summary: å–å¾—å¯è¨­ç‚ºä¸»æ¨çš„é æ¸¬åˆ—è¡¨
      description: |
        åƒ…å›å‚³ç›®å‰ç™»å…¥æœƒå“¡çš„ `pending + è³½äº‹æœªé–‹è³½` é æ¸¬ï¼Œæ–¹ä¾¿å‰ç«¯æä¾›ä¸»æ¨æŒ‘é¸æ¸…å–®ã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
      responses:
        '200':
          description: æˆåŠŸå›å‚³å€™é¸æ¸…å–®
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredictionListResponse'
        '401':
          description: æœªç™»å…¥/èªè­‰å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
  /me/avatar:
    post:
      tags: [me]
      summary: ä¸Šå‚³ä¸¦è¨­å®šæˆ‘çš„å¤§é ­è²¼ï¼ˆæœ¬æ©Ÿå„²å­˜ï¼‰
      description: |
        ä¸Šå‚³ç”¨æˆ¶é ­åƒï¼Œè¿”å›å®Œæ•´çš„ URL è·¯å¾‘ã€‚
        - æ”¯æ´æ ¼å¼ï¼šjpegã€pngã€webp
        - æª”æ¡ˆå¤§å°ï¼š< 5MB
        - è¿”å›ï¼šå®Œæ•´ URLï¼ˆhttps://api.sportspro.tw/uploads/avatars/xxx.jpgï¼‰
        - å‰ç«¯å¯ç›´æ¥ä½¿ç”¨è¿”å›çš„ URL
      security:
        - bearerAuth: []
        - cookieAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                avatar:
                  type: string
                  format: binary
                  description: é ­åƒåœ–ç‰‡æ–‡ä»¶
      responses:
        '200':
          description: ä¸Šå‚³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  url:
                    type: string
                    description: å®Œæ•´çš„é ­åƒ URLï¼Œå¯ç›´æ¥ä½¿ç”¨
                    example: "https://api.sportspro.tw/uploads/avatars/2-1761064089932.jpg"
                  updatedAt:
                    type: string
                    format: date-time
        '401': { $ref: '#/components/responses/Unauthorized' }
        '413':
          description: æª”æ¡ˆéå¤§
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '415':
          description: æª”æ¡ˆæ ¼å¼ä¸æ”¯æ´
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¸Šå‚³å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /me/name:
    patch:
      tags: [me]
      summary: æ›´æ–°æˆ‘çš„ç”¨æˆ¶åç¨±
      description: |
        æ›´æ–°ç•¶å‰ç”¨æˆ¶çš„é¡¯ç¤ºåç¨±
        - é•·åº¦ï¼š2-10 å­—å…ƒ
        - å…§å®¹ï¼šåƒ…å…è¨±ä¸­æ–‡å’Œè‹±æ–‡å­—æ¯
        - é »ç‡ï¼šç„¡é™åˆ¶
      security:
        - bearerAuth: []
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 2
                  maxLength: 10
                  description: ç”¨æˆ¶åç¨±ï¼ˆ2-10å­—å…ƒï¼Œåƒ…ä¸­è‹±æ–‡ï¼‰
                  example: "æ–°åç¨±"
              required: [name]
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  name:
                    type: string
                    example: "æ–°åç¨±"
                  updatedAt:
                    type: string
                    format: date-time
                    example: "2025-10-21T16:30:00.000Z"
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          description: åç¨±æ ¼å¼ä¸æ­£ç¢º
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NameValidationError'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /me/followings:
    get:
      tags: [me]
      summary: å–å¾—æˆ‘è¿½è¹¤çš„æœƒå“¡ï¼ˆæ˜ç‡ˆåˆ—è¡¨ï¼‰
      description: |
        å›å‚³ç•¶å‰ç™»å…¥æœƒå“¡è¿½è¹¤çš„æœƒå“¡æ¸…å–®ï¼Œå¯ç”¨æ–¼ã€Œæ˜ç‡ˆè¡¨ã€èˆ‡ç¤¾ç¾¤è¿½è¹¤é ã€‚
        - ä¾è¿½è¹¤æ™‚é–“ï¼ˆcreatedAtï¼‰éæ¸›æ’åº
        - æ”¯æ´åˆ†é èˆ‡é—œéµå­—æ¨¡ç³Šæœå°‹
        - æ¯é æœ€å¤š 100 ç­†
      security:
        - bearerAuth: []
        - cookieAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          description: ç¬¬å¹¾é ï¼Œé è¨­ç‚º 1
        - in: query
          name: size
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é ç­†æ•¸ï¼Œæœ€å¤§ 100
        - in: query
          name: keyword
          schema:
            type: string
          description: æœƒå“¡æš±ç¨±é—œéµå­—ï¼ˆå¤§å°å¯«ä¸æ•æ„Ÿï¼‰
      responses:
        '200':
          description: æˆåŠŸå›å‚³è¿½è¹¤æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/MemberFollowing'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      size:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 42
                      totalPages:
                        type: integer
                        example: 3
                      hasNext:
                        type: boolean
                        example: true
                  keyword:
                    type: string
                    nullable: true
                    description: è‹¥å¸¶å…¥é—œéµå­—å‰‡è¿”å›åŸå€¼
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /members/search:
    get:
      tags: [members]
      summary: ä»¥æš±ç¨±æœå°‹æœƒå“¡
      description: æ”¯æ´æ¨¡ç³ŠæŸ¥è©¢èˆ‡åˆ†é ï¼Œç™»å…¥ç‹€æ…‹ä¸‹æœƒå›å‚³è¿½è¹¤ç‹€æ…‹è³‡è¨Šã€‚
      parameters:
        - in: query
          name: nickname
          schema:
            type: string
            minLength: 1
          required: true
          description: æš±ç¨±é—œéµå­—ï¼ˆå¤§å°å¯«ä¸æ•æ„Ÿï¼‰
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
          required: false
          description: é ç¢¼ï¼ˆé è¨­ 1ï¼‰
        - in: query
          name: pageSize
          schema:
            type: integer
            minimum: 1
            maximum: 50
          required: false
          description: æ¯é ç­†æ•¸ï¼ˆé è¨­ 20ï¼Œæœ€å¤§ 50ï¼‰
      responses:
        '200':
          description: æœå°‹çµæœåˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  keyword:
                    type: string
                    description: å¯¦éš›ä½¿ç”¨çš„æœå°‹é—œéµå­—
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/MemberSearchResult'
                  pagination:
                    $ref: '#/components/schemas/PageMeta'
        '422':
          description: ç¼ºå°‘å¿…å¡«åƒæ•¸æˆ–æ ¼å¼éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /members/recommendations:
    get:
      tags: [members]
      summary: æ¨è–¦æœƒå“¡ï¼ˆTop 5ï¼‰
      description: ä¾é æ¸¬æ­£ç¢ºç‡å„ªå…ˆæ’åºï¼Œä¸è¶³äº”ä½æ™‚ä»¥ç­‰ç´šæœ€é«˜è€…è£œè¶³ã€‚
      responses:
        '200':
          description: æ¨è–¦æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  recommendations:
                    type: array
                    items:
                      $ref: '#/components/schemas/MemberRecommendation'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /livescore:
    get:
      tags: [livescore]
      summary: æŸ¥è©¢å³æ™‚æ¯”åˆ†åˆ—è¡¨
      description: ä¾ç…§ç‹€æ…‹ã€è¯ç›Ÿæˆ–æ—¥æœŸç¯©é¸è³½äº‹ï¼Œå›å‚³å³æ™‚æ¯”åˆ†èˆ‡çµ±è¨ˆè³‡æ–™ã€‚
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum: [scheduled, live, finished]
          required: false
          description: è³½äº‹ç‹€æ…‹ï¼ŒæœªæŒ‡å®šæ™‚å›å‚³å…¨éƒ¨ç‹€æ…‹ã€‚
        - in: query
          name: allianceId
          schema:
            type: integer
          required: false
          description: è¯ç›Ÿè­˜åˆ¥ç¢¼ï¼ˆå°æ‡‰å¾Œç«¯ allianceIdï¼‰ã€‚
        - in: query
          name: leagueCode
          schema:
            type: string
          required: false
          description: è¯ç›Ÿä»£ç¢¼ï¼ˆå¦‚ NBAã€MLBï¼‰ï¼Œä¾›å‰ç«¯ä½¿ç”¨æ—¢æœ‰ä»£ç¢¼é€²è¡Œç¯©é¸ã€‚
        - in: query
          name: soccerLeagueId
          schema:
            type: integer
          required: false
          description: è¶³çƒå­è¯è³½è­˜åˆ¥ç¢¼ã€‚
        - in: query
          name: date
          schema:
            type: string
            format: date
          required: false
          description: è³½äº‹æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰ï¼Œåƒ…å›å‚³ç•¶æ—¥æ¯”è³½ã€‚
        - in: query
          name: page
          schema:
            type: integer
            default: 1
            minimum: 1
          required: false
          description: åˆ†é é ç¢¼ï¼ˆé è¨­ 1ï¼‰ã€‚
        - in: query
          name: size
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          required: false
          description: æ¯é ç­†æ•¸ï¼ˆé è¨­ 20ï¼Œæœ€å¤§ 100ï¼‰ã€‚
      responses:
        '200':
          description: æˆåŠŸå›å‚³å³æ™‚æ¯”åˆ†æ¸…å–®
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/LivescoreItem'
                  pagination:
                    $ref: '#/components/schemas/PageMeta'
        '400':
          description: æŸ¥è©¢åƒæ•¸éŒ¯èª¤ï¼ˆä¾‹å¦‚ status ä¸æ”¯æ´ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/games/{id}/prediction-stats:
    get:
      tags: [games]
      summary: æŸ¥è©¢è³½äº‹é æ¸¬æ¯”ä¾‹çµ±è¨ˆ
      description: |
        å›å‚³æŒ‡å®šè³½äº‹çš„é æ¸¬çµ±è¨ˆè³‡æ–™ï¼Œä¾é æ¸¬é¡å‹åˆ†çµ„é¡¯ç¤ºå„é¸é …çš„é æ¸¬æ•¸é‡èˆ‡ç™¾åˆ†æ¯”ã€‚
        çµ±è¨ˆçµæœæœƒå¿«å– 60 ç§’ä»¥æå‡æ•ˆèƒ½ã€‚
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: è³½äº‹ IDï¼ˆä¾‹å¦‚ï¼šMLB20251111007ï¼‰
      responses:
        '200':
          description: æˆåŠŸå›å‚³é æ¸¬çµ±è¨ˆè³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      totalPredictions:
                        type: integer
                        description: è©²è³½äº‹çš„ç¸½é æ¸¬æ•¸é‡
                        example: 150
                      byType:
                        type: object
                        description: ä¾é æ¸¬é¡å‹åˆ†çµ„çš„çµ±è¨ˆè³‡æ–™
                        additionalProperties:
                          type: object
                          properties:
                            total:
                              type: integer
                              description: è©²é¡å‹çš„ç¸½é æ¸¬æ•¸
                              example: 80
                            selections:
                              type: object
                              description: å„é¸é …çš„çµ±è¨ˆè³‡æ–™
                              additionalProperties:
                                type: object
                                properties:
                                  count:
                                    type: integer
                                    description: è©²é¸é …çš„é æ¸¬æ•¸é‡
                                    example: 48
                                  percentage:
                                    type: integer
                                    description: è©²é¸é …çš„ç™¾åˆ†æ¯”ï¼ˆå››æ¨äº”å…¥ï¼‰
                                    example: 60
              examples:
                æœ‰é æ¸¬è³‡æ–™:
                  value:
                    success: true
                    data:
                      totalPredictions: 150
                      byType:
                        international_spread:
                          total: 80
                          selections:
                            home:
                              count: 48
                              percentage: 60
                            away:
                              count: 32
                              percentage: 40
                        international_total:
                          total: 70
                          selections:
                            over:
                              count: 49
                              percentage: 70
                            under:
                              count: 21
                              percentage: 30
                ç„¡é æ¸¬è³‡æ–™:
                  value:
                    success: true
                    data:
                      totalPredictions: 0
                      byType: {}
        '404':
          description: è³½äº‹ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "è³½äº‹ä¸å­˜åœ¨"
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "å–å¾—è³½äº‹é æ¸¬çµ±è¨ˆå¤±æ•—"

  /members/{id}/profile:
    get:
      tags: [members]
      summary: æœƒå“¡åŸºæœ¬è³‡æ–™
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: æœƒå“¡åŸºæœ¬è³‡æ–™åŠç­‰ç´šè³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  profile:
                    $ref: '#/components/schemas/MemberProfile'
                  relationships:
                    type: object
                    properties:
                      isSelf:
                        type: boolean
                        description: æ˜¯å¦ç‚ºæœ¬äºº
                      isFollowing:
                        type: boolean
                        description: æ˜¯å¦å·²è¿½è¹¤
                      isMutual:
                        type: boolean
                        description: æ˜¯å¦äº’ç›¸é—œæ³¨
                  permissions:
                    type: object
                    properties:
                      canViewCoinInfo:
                        type: boolean
                        description: æ˜¯å¦å¯æª¢è¦–å½©å¹£å¸³æˆ¶è³‡è¨Šï¼ˆåƒ…æœ¬äººæˆ–ç®¡ç†å“¡ç‚º trueï¼‰
                        example: true

  /members/{id}/forum-stats:
    get:
      tags: [members]
      summary: æœƒå“¡è«–å£‡çµ±è¨ˆè³‡æ–™
      description: |
        ç²å–æŒ‡å®šæœƒå“¡åœ¨è¨è«–å€çš„æ•´é«”çµ±è¨ˆè³‡æ–™ï¼Œç”¨æ–¼æœƒå“¡é ã€Œè¨è«–å€ã€ç¸½è¦½å¡ç‰‡ã€‚
        - ç„¡éœ€ç™»å…¥å³å¯æŸ¥çœ‹
        - åªçµ±è¨ˆæœªåˆªé™¤çš„æ–‡ç« 
        - ç†±é–€æ–‡ç« æ¨™æº–ï¼šè®šæ•¸ â‰¥ 10 æˆ– å›è¦†æ•¸ â‰¥ 5
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: è«–å£‡çµ±è¨ˆè³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/MemberForumStats'
              examples:
                æœ‰ç™¼æ–‡è¨˜éŒ„:
                  value:
                    success: true
                    data:
                      hotPosts: 3
                      totalPosts: 18
                      commentsReceived: 42
                      commentsWritten: 15
                      totalComments: 42
                      totalLikes: 67
                ç„¡ç™¼æ–‡è¨˜éŒ„:
                  value:
                    success: true
                    data:
                      hotPosts: 0
                      totalPosts: 0
                      commentsReceived: 0
                      commentsWritten: 0
                      totalComments: 0
                      totalLikes: 0
        '400':
          description: ç„¡æ•ˆçš„æœƒå“¡ ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: æœƒå“¡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /members/{id}/relationships:
    get:
      tags: [members]
      summary: æœƒå“¡èˆ‡ç›®å‰ä½¿ç”¨è€…çš„é—œä¿‚
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: é—œä¿‚è³‡è¨Š
          content:
            application/json:
              schema:
                type: object
                properties:
                  isSelf:
                    type: boolean
                  isFollowing:
                    type: boolean
                  isMutual:
                    type: boolean

  /members/{id}/follow:
    post:
      tags: [members]
      summary: è¿½è¹¤æœƒå“¡
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '204': { description: æˆåŠŸ }
        '401': { $ref: '#/components/responses/Unauthorized' }
    delete:
      tags: [members]
      summary: å–æ¶ˆè¿½è¹¤æœƒå“¡
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '204': { description: æˆåŠŸ }
        '401': { $ref: '#/components/responses/Unauthorized' }

  /members/{id}/stats:
    get:
      tags: [members]
      summary: æœƒå“¡çµ±è¨ˆè³‡è¨Š
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: Stats
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MemberStats'
        '404':
          $ref: '#/components/responses/NotFound'

  /api/members/{id}/prediction-stats:
    get:
      tags: [members]
      summary: æœƒå“¡é æ¸¬æˆç¸¾çµ±è¨ˆ
      description: |
        å…¬é–‹ç«¯é»ï¼Œä»»ä½•ä½¿ç”¨è€…çš†å¯è¼¸å…¥æœƒå“¡ ID æª¢è¦–å…¶æ­·å²é æ¸¬ç¸½è¦½ï¼Œç”¨æ–¼å‰ç«¯æœƒå“¡é å¡ç‰‡ã€‚
        å…§å®¹åŒ…å«ç¸½å ´æ¬¡ã€å‹æ•—/æœªçµç®—ç­†æ•¸ã€å‘½ä¸­ç‡ã€ç•¶å‰é€£å‹/é€£æ•—ä»¥åŠæœ€è¿‘ä¸€æ¬¡çµç®—æ™‚é–“ã€‚
      security:
        - bearerAuth: []
        - cookieAuth: []
        - {}
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: æˆåŠŸå›å‚³çµ±è¨ˆè³‡æ–™
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  stats:
                    $ref: '#/components/schemas/MemberPredictionStats'
              examples:
                example:
                  value:
                    success: true
                    stats:
                      totals:
                        total: 5
                        settled: 5
                        pending: 0
                        win: 4
                        lose: 1
                        cancelled: 0
                      accuracy: 80
                      currentStreak:
                        type: "win"
                        count: 3
                      lastResultAt: "2025-11-13T21:31:12.371Z"
        '400':
          description: æœƒå“¡ ID æ ¼å¼éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: æœƒå“¡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/members/{id}/predictions:
    get:
      tags: [members, predictions]
      summary: æœƒå“¡é æ¸¬æˆ°ç¸¾åˆ—è¡¨
      description: |
        èˆ‡ `/api/predictions` ç›¸åŒçš„æŸ¥è©¢ä»‹é¢ï¼Œä½† `memberId` ç”±è·¯å¾‘åƒæ•¸æŒ‡å®šï¼Œå¯ç›´æ¥ç”¨æ–¼æœƒå“¡é ç±¤é¡¯ç¤ºæ­·å²æˆ°ç¸¾ã€‚
        - åŒ¿åå³å¯æŸ¥è©¢ä»–äººæˆ°ç¸¾ï¼ˆåƒ…å…¬é–‹æ¬„ä½ï¼‰
        - è‹¥å¸¶å…¥è‡ªå·±çš„ ID ä¸¦é™„ä¸Š Session/JWTï¼Œæœƒé¡¯ç¤ºå®Œæ•´ selection/note èˆ‡è³¼è²·ç‹€æ…‹
      security:
        - bearerAuth: []
        - cookieAuth: []
        - {}
      parameters:
        - $ref: '#/components/parameters/MemberId'
        - in: query
          name: status
          schema:
            type: string
            enum: [pending, win, lose, cancelled, all]
            default: all
          required: false
        - in: query
          name: allianceId
          schema:
            type: integer
          required: false
        - in: query
          name: startDate
          schema:
            type: string
            format: date
          required: false
        - in: query
          name: endDate
          schema:
            type: string
            format: date
          required: false
        - in: query
          name: dateRange
          schema:
            type: string
            enum: [today, week, month, past7, past30, all]
          required: false
        - in: query
          name: gameMode
          schema:
            type: string
            enum: [international, taiwan, all]
          required: false
        - in: query
          name: sortBy
          schema:
            type: string
            enum: [createdAt, settledAt]
            default: settledAt
          required: false
        - in: query
          name: order
          schema:
            type: string
            enum: [asc, desc]
            default: desc
          required: false
        - in: query
          name: page
          schema:
            type: integer
            minimum: 1
            default: 1
          required: false
        - in: query
          name: size
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 20
          required: false
      responses:
        '200':
          description: æœƒå“¡é æ¸¬åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredictionListResponse'
        '400':
          description: åƒæ•¸éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: æœƒå“¡ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: ä¼ºæœå™¨éŒ¯èª¤
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /members/{id}/honors:
    get:
      tags: [members]
      summary: æœƒå“¡æ¦®è­½åˆ—è¡¨
      parameters:
        - $ref: '#/components/parameters/MemberId'
      responses:
        '200':
          description: honors
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/MemberHonor'

  /members/{id}/predictions:
    get:
      tags: [members]
      summary: æœƒå“¡é æ¸¬åˆ—è¡¨ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      parameters:
        - $ref: '#/components/parameters/MemberId'
        - $ref: '#/components/parameters/League'
        - $ref: '#/components/parameters/DateRange'
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
      responses:
        '200':
          description: é æ¸¬æ¸…å–®ï¼ˆåˆ†é ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PredictionListResponse'

  /members/{id}/posts:
    get:
      tags: [posts]
      summary: æœƒå“¡ç™¼æ–‡åˆ—è¡¨ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      parameters:
        - $ref: '#/components/parameters/MemberId'
        - $ref: '#/components/parameters/Page'
        - $ref: '#/components/parameters/Size'
      responses:
        '200':
          description: ç™¼æ–‡æ¸…å–®ï¼ˆåˆ†é ï¼‰
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostsResponse'

  /filters/leagues:
    get:
      tags: [filters]
      summary: è¯ç›Ÿå­—å…¸ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      responses:
        '200':
          description: leagues
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/League'

  /filters/dates:
    get:
      tags: [filters]
      summary: æ—¥æœŸå­—å…¸ï¼ˆè¿‘ N å¤©ï¼‰ï¼ˆæœªå®Œæˆ/æš«ä¸æä¾›ï¼‰
      description: æœªå®Œæˆ/æš«ä¸æä¾›
      parameters:
        - in: query
          name: range
          schema:
            type: integer
            minimum: 1
            maximum: 31
          description: å›å‚³æœ€è¿‘ N å¤©ï¼ˆå«ä»Šå¤©ï¼‰
      responses:
        '200':
          description: dates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/DateFilterItem'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    cookieAuth:
      type: apiKey
      in: cookie
      name: sgame_session

  parameters:
    MemberId:
      in: path
      name: id
      required: true
      schema:
        type: string
      description: æœƒå“¡ ID æˆ–ä»£è™Ÿ
    League:
      in: query
      name: league
      schema:
        type: string
        description: è¯ç›Ÿä»£ç¢¼ï¼ˆä¾‹å¦‚ MLB/NPB/CPBLï¼‰
    DateRange:
      in: query
      name: dateRange
      schema:
        type: string
        enum: [today, week, month]
      description: é è¨­ç”¨ today/week/monthï¼›è‹¥æ¡ç”¨ç²¾ç¢ºæ—¥æœŸï¼Œæ”¹èµ° /filters/dates èˆ‡é¡å¤– date=YYYY-MM-DD åƒæ•¸
    Page:
      in: query
      name: page
      schema:
        type: integer
        minimum: 1
        default: 1
    Size:
      in: query
      name: size
      schema:
        type: integer
        minimum: 1
        maximum: 50
        default: 20
    OAuthProvider:
      in: path
      name: provider
      required: true
      schema:
        type: string
        enum: [google, facebook, line]
      description: ç¬¬ä¸‰æ–¹ç™»å…¥ä¾›æ‡‰å•†
    RedirectUrl:
      in: query
      name: redirectUrl
      required: false
      schema:
        type: string
      description: ç™»å…¥å®Œæˆå¾Œå°å›çš„ç›¸å°è·¯å¾‘ï¼Œå¾Œç«¯éœ€åšç™½åå–®æª¢æŸ¥

  responses:
    Unauthorized:
      description: æœªæˆæ¬Š
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    OAuthError:
      description: ç¬¬ä¸‰æ–¹ç™»å…¥éŒ¯èª¤
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/OAuthError'

  schemas:
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ˜¯å¦æˆåŠŸï¼ŒéŒ¯èª¤æ™‚å›ºå®šç‚º false
          example: false
        code:
          type: string
        message:
          type: string

    OAuthError:
      type: object
      properties:
        code:
          type: string
          enum: [OAUTH_PROVIDER_DENIED, OAUTH_INVALID_STATE, OAUTH_EXCHANGE_FAILED, OAUTH_REDIRECT_INVALID]
        message:
          type: string
        reload:
          type: boolean

    PageMeta:
      type: object
      properties:
        page:
          type: integer
        size:
          type: integer
        total:
          type: integer
        totalPages:
          type: integer
          description: ç¸½é æ•¸
        hasNext:
          type: boolean
          description: æ˜¯å¦ä»æœ‰ä¸‹ä¸€é 

    LivescoreTeam:
      type: object
      properties:
        id:
          type: integer
          description: éšŠä¼è³‡æ–™åº«è­˜åˆ¥ç¢¼
          example: 9101
        name:
          type: string
          description: éšŠä¼é¡¯ç¤ºåç¨±
          example: "æ´›æ‰ç£¯æ¹–äºº"
        pitcher:
          type: string
          nullable: true
          description: æŠ•æ‰‹æˆ–å…ˆç™¼çƒå“¡è³‡è¨Šï¼ˆåƒ…æ£’çƒç­‰éœ€è¦æ™‚æä¾›ï¼‰
          example: "å¤§è°·ç¿”å¹³"

    LivescoreOdds:
      type: object
      properties:
        international:
          type: object
          description: åœ‹éš›ç›¤è³ ç‡çµæ§‹ï¼ˆåŸæ¨£å›å‚³ï¼‰
          example:
            spread:
              home: { line: "-5.5", odds: "1.90" }
              away: { line: "+5.5", odds: "1.90" }
            total:
              over: { line: "225.5", odds: "1.88" }
              under: { line: "225.5", odds: "1.92" }
        taiwan:
          type: object
          description: å°ç£ç›¤è³ ç‡çµæ§‹ï¼ˆåŸæ¨£å›å‚³ï¼‰
          example:
            moneyline:
              home: { odds: "1.45" }
              away: { odds: "2.75" }
            spread:
              home: { line: "-5.5", odds: "1.90" }
              away: { line: "+5.5", odds: "1.90" }
        live:
          type: object
          nullable: true
          description: å³æ™‚è³ ç‡è³‡æ–™ï¼Œè‹¥å°šæœªä¸²æ¥å³ç‚º null
          example:
            moneyline:
              home: { odds: "1.60" }
              away: { odds: "2.30" }

    LivescoreItem:
      type: object
      properties:
        game_id:
          type: string
          description: è³½äº‹å”¯ä¸€ç·¨è™Ÿï¼ˆå­—ä¸²æ ¼å¼ï¼‰
          example: "20251024TEST009"
        alliance_id:
          type: integer
          description: è¯ç›Ÿè­˜åˆ¥ç¢¼
          example: 2
        league_code:
          type: string
          description: è¯ç›Ÿä»£ç¢¼ï¼ˆå°æ‡‰å‰ç«¯ç¯©é¸æ¢ä»¶ï¼‰
          example: "NBA"
        alliance_name:
          type: string
          description: è¯ç›Ÿä¸­æ–‡åç¨±
          example: "ç¾åœ‹è·ç±ƒ"
        sport_type:
          type: string
          description: é‹å‹•é¡å‹ï¼ˆbaseballã€basketballã€soccerç­‰ï¼‰
          example: "basketball"
        status:
          type: string
          enum: [scheduled, live, finished]
          description: è³½äº‹ç‹€æ…‹
          example: "live"
        start_time:
          type: string
          description: é–‹è³½æ™‚é–“ï¼ˆçµ„åˆ YYYY-MM-DD èˆ‡ HH:mmï¼Œæ ¼å¼ yyyy-MM-ddTHH:mm:ssï¼‰
          example: "2025-10-24T19:30:00"
        home_team:
          $ref: '#/components/schemas/LivescoreTeam'
        away_team:
          $ref: '#/components/schemas/LivescoreTeam'
        home_score:
          type: integer
          nullable: true
          description: ä¸»éšŠç›®å‰åˆ†æ•¸ï¼Œæœªé–‹è³½æ™‚ç‚º null
          example: 98
        away_score:
          type: integer
          nullable: true
          description: å®¢éšŠç›®å‰åˆ†æ•¸ï¼Œæœªé–‹è³½æ™‚ç‚º null
          example: 102
        live_phase:
          type: string
          nullable: true
          description: ç•¶å‰æ¯”è³½éšæ®µï¼ˆä¾‹ï¼š"Q3 05:21"ã€"7å±€ä¸Š"ï¼‰
          example: "Q4 02:14"
        scoreboard_detail:
          type: object
          nullable: true
          description: å„ç¯€/å±€åˆ†æ•¸ç´°ç¯€ï¼Œçµæ§‹ä¾é‹å‹•é¡å‹æä¾›
          example:
            periods:
              - label: "Q1"
                home: 25
                away: 30
              - label: "Q2"
                home: 28
                away: 22
              - label: "Q3"
                home: 24
                away: 27
              - label: "Q4"
                home: 21
                away: 19
        live_stats:
          type: object
          nullable: true
          description: å³æ™‚çµ±è¨ˆè³‡æ–™ï¼ˆå¦‚æŠ•æ‰‹è³‡è¨Šã€é—œéµæ•¸æ“šç­‰ï¼‰
          example:
            keyPlayer: "LeBron James"
            points: 32
            assists: 8
        odds_info:
          $ref: '#/components/schemas/LivescoreOdds'
        soccer_league:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              description: è¶³çƒå­è¯è³½è­˜åˆ¥ç¢¼
              example: 501
            name:
              type: string
              nullable: true
              description: è¶³çƒè¯è³½åç¨±
              example: "è‹±æ ¼è˜­è¶…ç´šè¯è³½"
        last_updated:
          type: string
          format: date-time
          description: è³‡æ–™æœ€å¾Œæ›´æ–°æ™‚é–“ï¼ˆISO 8601ï¼‰
          example: "2025-11-04T08:21:15.123Z"

    LevelInfo:
      type: object
      properties:
        code:
          type: string
        name:
          type: string
        nameEn:
          type: string
        color:
          type: string
        icon:
          type: string
        minScore:
          type: number
        maxScore:
          type: number
          nullable: true
        description:
          type: string
        benefits:
          type: array
          items:
            type: string

    League:
      type: object
      properties:
        id:
          type: integer
        code:
          type: string
          example: MLB
        name:
          type: string

    DateFilterItem:
      type: object
      properties:
        key:
          type: string
          example: '2025-09-16'
        label:
          type: string
          example: '09/16(äºŒ)'

    MemberProfile:
      type: object
      properties:
        id:
          type: integer
          description: ç”¨æˆ¶ID
        email:
          type: string
          format: email
          description: ç”¨æˆ¶éƒµç®±
        name:
          type: string
          description: ç”¨æˆ¶åç¨±
        avatarUrl:
          type: string
          nullable: true
          description: é ­åƒå®Œæ•´ URLï¼ˆæœ¬åœ°ä¸Šå‚³ï¼šhttps://api.sportspro.tw/uploads/avatars/xxx.jpgï¼ŒGoogle OAuthï¼šhttps://lh3.googleusercontent.com/...ï¼‰
          example: "https://api.sportspro.tw/uploads/avatars/3-1762490554611.jpg"
        emailVerified:
          type: boolean
          description: éƒµç®±æ˜¯å¦å·²é©—è­‰
        createdAt:
          type: string
          format: date-time
          description: è¨»å†Šæ™‚é–“
        updatedAt:
          type: string
          format: date-time
        settledAt:
          type: string
          format: date-time
          nullable: true
          description: é æ¸¬çµç®—æ™‚é–“ï¼Œæœªçµç®—æ™‚ç‚º null
          description: æœ€å¾Œæ›´æ–°æ™‚é–“
        level:
          type: string
          description: ç­‰ç´šä»£ç¢¼
        score:
          type: integer
          description: ç”¨æˆ¶åˆ†æ•¸ï¼Œç”¨æ–¼ç­‰ç´šè¨ˆç®—
        bio:
          type: string
          description: å€‹äººç°¡ä»‹
        joinedAt:
          type: string
          format: date-time
          description: åŠ å…¥æ™‚é–“
        followersCount:
          type: integer
          description: è¿½è¹¤è€…æ•¸é‡
        followingCount:
          type: integer
          description: è¿½è¹¤ä¸­æ•¸é‡
        levelInfo:
          $ref: '#/components/schemas/LevelInfo'
        levelProgress:
          type: object
          properties:
            percentage:
              type: number
            currentScore:
              type: number
            levelMinScore:
              type: number
            levelMaxScore:
              type: number
            pointsToNext:
              type: number
        nextLevel:
          $ref: '#/components/schemas/LevelInfo'

    MemberSearchResult:
      type: object
      properties:
        id:
          type: integer
          description: ç”¨æˆ¶ID
        name:
          type: string
          description: æš±ç¨±
        avatarUrl:
          type: string
          nullable: true
          description: å¤§é ­è²¼å®Œæ•´ URLï¼ˆå¯ç›´æ¥ä½¿ç”¨ï¼‰
          example: "https://api.sportspro.tw/uploads/avatars/3-1762490554611.jpg"
        level:
          type: string
          description: ç­‰ç´šä»£ç¢¼
        levelInfo:
          $ref: '#/components/schemas/LevelInfo'
        score:
          type: integer
          description: ç´¯ç©ç¶“é©—å€¼
        followersCount:
          type: integer
          description: è¿½è¹¤è€…æ•¸é‡
        followingCount:
          type: integer
          description: è¿½è¹¤ä¸­æ•¸é‡
        joinedAt:
          type: string
          format: date-time
          description: åŠ å…¥æ™‚é–“
        relationships:
          type: object
          properties:
            isSelf:
              type: boolean
            isFollowing:
              type: boolean
            canFollow:
              type: boolean

    MemberRecommendation:
      allOf:
        - $ref: '#/components/schemas/MemberSearchResult'
        - type: object
          properties:
            recommendation:
              type: object
              properties:
                type:
                  type: string
                  enum: [accuracy, level]
                  description: æ¨è–¦ä¾†æºé¡å‹
                accuracy:
                  type: number
                  format: float
                  description: é æ¸¬æ­£ç¢ºç‡ï¼ˆåƒ… accuracy é¡å‹ï¼‰
                winCount:
                  type: integer
                  description: å‹å ´æ•¸ï¼ˆåƒ… accuracy é¡å‹ï¼‰
                totalPredictions:
                  type: integer
                  description: é æ¸¬å ´æ¬¡ï¼ˆåƒ… accuracy é¡å‹ï¼‰
                reason:
                  type: string
                  description: äººé¡å¯è®€çš„æ¨è–¦ç†ç”±

    MemberFollowing:
      allOf:
        - $ref: '#/components/schemas/MemberSearchResult'
        - type: object
          properties:
            followingSince:
              type: string
              format: date-time
              description: è¿½è¹¤å»ºç«‹æ™‚é–“ï¼ˆISO 8601ï¼‰

    MemberForumStats:
      type: object
      description: æœƒå“¡è«–å£‡çµ±è¨ˆè³‡æ–™
      properties:
        hotPosts:
          type: integer
          description: ç†±é–€æ–‡ç« æ•¸ï¼ˆåˆ¤å®šæ¨™æº–ï¼šè®šæ•¸ â‰¥ 10 æˆ– å›è¦†æ•¸ â‰¥ 5ï¼‰
          example: 3
        totalPosts:
          type: integer
          description: ç¸½ç™¼æ–‡æ•¸ï¼ˆå«æ‰€æœ‰å…¬é–‹æ–‡ç« ï¼Œä¸å«å·²åˆªé™¤ï¼‰
          example: 18
        commentsReceived:
          type: integer
          description: æœƒå“¡æ–‡ç« æ”¶åˆ°çš„ç¸½å›è¦†æ•¸ï¼ˆæ‰€æœ‰æ–‡ç« çš„ commentCount ç¸½å’Œï¼‰
          example: 42
        commentsWritten:
          type: integer
          description: æœƒå“¡åœ¨å…¨ç«™å¯«å‡ºçš„ç¸½å›è¦†æ•¸ï¼ˆåŒ…å«åœ¨ä»–äººæ–‡ç« ç•™è¨€ï¼‰
          example: 15
        totalComments:
          type: integer
          deprecated: true
          description: èˆ‡ `commentsReceived` ç›¸åŒï¼Œæš«æ™‚ä¿ç•™çµ¦èˆŠç‰ˆå‰ç«¯
          example: 42
        totalLikes:
          type: integer
          description: æœƒå“¡æ–‡ç« ç´¯ç©çš„ç¸½è®šæ•¸ï¼ˆæ‰€æœ‰æ–‡ç« çš„ likeCount ç¸½å’Œï¼‰
          example: 67

    MemberStats:
      type: object
      properties:
        totalPredictions:
          type: integer
        winRate:
          type: number
          format: float
        winStreak:
          type: integer
        ranking:
          type: integer

    MemberPredictionStats:
      type: object
      properties:
        totals:
          type: object
          properties:
            total:
              type: integer
            settled:
              type: integer
            pending:
              type: integer
            win:
              type: integer
            lose:
              type: integer
            cancelled:
              type: integer
        accuracy:
          type: number
          format: float
          nullable: true
        currentStreak:
          type: object
          nullable: true
          properties:
            type:
              type: string
              enum: [win, lose]
            count:
              type: integer
        lastResultAt:
          type: string
          format: date-time
          nullable: true

    MemberHonor:
      type: object
      properties:
        id:
          type: integer
        icon:
          type: string
        title:
          type: string
        description:
          type: string
        date:
          type: string
          format: date

    MemberPost:
      type: object
      properties:
        id:
          type: integer
        board:
          type: string
        title:
          type: string
        url:
          type: string
        createdAt:
          type: string
          format: date-time
        replies:
          type: integer
        views:
          type: integer
        push:
          type: integer

    PredictionGameInfo:
      type: object
      properties:
        allianceId:
          type: integer
        allianceName:
          type: string
          description: è¯ç›Ÿä»£ç¢¼
          example: MLB
        sportType:
          type: string
          example: baseball
        status:
          type: string
          description: è³½äº‹ç‹€æ…‹ï¼ˆscheduled/live/finished...ï¼‰
        gameDate:
          type: string
          format: date
          example: "2025-11-13"
        gameTime:
          type: string
          nullable: true
          description: é–‹è³½æ™‚é–“ï¼ˆHH:mmï¼‰
        homeTeam:
          type: string
        awayTeam:
          type: string
        finalScore:
          type: object
          nullable: true
          properties:
            home:
              type: integer
            away:
              type: integer

    PredictionListItem:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        userName:
          type: string
        userAvatarUrl:
          type: string
          nullable: true
          description: é ­åƒå®Œæ•´ URL
        gameId:
          type: string
        gameInfo:
          $ref: '#/components/schemas/PredictionGameInfo'
        predictionType:
          type: string
        predictionTypeLabel:
          type: string
        selection:
          type: string
          nullable: true
          description: åƒ…ä½œè€…æˆ–å·²è³¼è²·è€…å¯è¦‹
        selectionLabel:
          type: string
          nullable: true
        odds:
          type: string
        price:
          type: number
        isMainPick:
          type: boolean
        isFeatured:
          type: boolean
          description: æ˜¯å¦ç‚ºä¸»æ¨
        featuredAt:
          type: string
          format: date-time
          nullable: true
          description: è¨­ç‚ºä¸»æ¨çš„æ™‚é–“
        featuredBy:
          type: integer
          nullable: true
          description: è¨­ç‚ºä¸»æ¨çš„æ“ä½œè€… ID
        featuredNote:
          type: string
          nullable: true
          description: ä¸»æ¨å‚™è¨»
        note:
          type: string
          nullable: true
          description: åƒ…ä½œè€…æˆ–å·²è³¼è²·è€…å¯è¦‹
        status:
          type: string
          enum: [pending, win, lose, cancelled]
        isPurchased:
          type: boolean
        isOwn:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PredictionListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: array
          items:
            $ref: '#/components/schemas/PredictionListItem'
        pagination:
          $ref: '#/components/schemas/PageMeta'

    PostsResponse:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/MemberPost'
        pageMeta:
          $ref: '#/components/schemas/PageMeta'

    VerificationResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        message:
          type: string
          description: å›æ‡‰è¨Šæ¯
        expiresIn:
          type: integer
          description: é©—è­‰ç¢¼éæœŸæ™‚é–“ï¼ˆç§’ï¼‰
          example: 300

    VerificationStatusResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        isVerified:
          type: boolean
          description: éƒµç®±æ˜¯å¦å·²é©—è­‰
        email:
          type: string
          format: email
          description: ç”¨æˆ¶éƒµç®±åœ°å€

    EmailVerificationError:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
          default: false
        message:
          type: string
          description: éŒ¯èª¤è¨Šæ¯
        code:
          type: string
          enum: 
            - VERIFICATION_CODE_EXPIRED
            - VERIFICATION_CODE_INVALID
            - EMAIL_ALREADY_VERIFIED
            - RATE_LIMIT_EXCEEDED
            - VERIFICATION_SEND_FAILED
          description: éŒ¯èª¤ä»£ç¢¼

    PasswordWeakError:
      type: object
      properties:
        code:
          type: string
          enum: [PASSWORD_WEAK]
          description: å¯†ç¢¼å¼·åº¦éŒ¯èª¤ä»£ç¢¼
        message:
          type: string
          description: äººé¡å¯è®€çš„éŒ¯èª¤è¨Šæ¯
          example: "å¯†ç¢¼éœ€ç‚º 8â€“12 ç¢¼ï¼Œå«å¤§å°å¯«ã€æ•¸å­—èˆ‡ç‰¹æ®Šç¬¦è™Ÿï¼Œä¸å¯å«ç©ºç™½ï¼Œä¸”ä¸å¯èˆ‡ Email ç›¸é—œ"
        details:
          type: object
          description: æ©Ÿå™¨å¯è®€çš„é©—è­‰è©³æƒ…
          properties:
            length:
              type: boolean
              description: é•·åº¦æ˜¯å¦ç¬¦åˆè¦æ±‚ (8-12)
            hasUpper:
              type: boolean
              description: æ˜¯å¦åŒ…å«å¤§å¯«å­—æ¯
            hasLower:
              type: boolean
              description: æ˜¯å¦åŒ…å«å°å¯«å­—æ¯
            hasNumber:
              type: boolean
              description: æ˜¯å¦åŒ…å«æ•¸å­—
            hasSpecial:
              type: boolean
              description: æ˜¯å¦åŒ…å«ç‰¹æ®Šå­—å…ƒ
            noWhitespace:
              type: boolean
              description: æ˜¯å¦ä¸åŒ…å«ç©ºç™½å­—å…ƒ
            notEmailLike:
              type: boolean
              description: æ˜¯å¦èˆ‡ Email ç„¡é—œ
        errors:
          type: array
          description: å…·é«”éŒ¯èª¤è¨Šæ¯åˆ—è¡¨
          items:
            type: string
          example: ["å¯†ç¢¼é•·åº¦å¿…é ˆç‚º 8-12 å­—å…ƒ", "å¯†ç¢¼å¿…é ˆåŒ…å«è‡³å°‘ä¸€å€‹å¤§å¯«å­—æ¯"]

    TooManyAttemptsError:
      type: object
      properties:
        code:
          type: string
          enum: [TOO_MANY_ATTEMPTS]
          description: è«‹æ±‚éæ–¼é »ç¹éŒ¯èª¤ä»£ç¢¼
        message:
          type: string
          description: éŒ¯èª¤è¨Šæ¯
          example: "è¨»å†Šå˜—è©¦éæ–¼é »ç¹ï¼Œè«‹ç¨å¾Œå†è©¦"

    NameValidationError:
      type: object
      properties:
        success:
          type: boolean
          default: false
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        code:
          type: string
          enum: [NAME_INVALID]
          description: åç¨±é©—è­‰éŒ¯èª¤ä»£ç¢¼
        message:
          type: string
          description: äººé¡å¯è®€çš„éŒ¯èª¤è¨Šæ¯
          example: "åç¨±æ ¼å¼ä¸æ­£ç¢º"
        details:
          type: object
          description: æ©Ÿå™¨å¯è®€çš„é©—è­‰è©³æƒ…
          properties:
            length:
              type: boolean
              description: é•·åº¦æ˜¯å¦ç¬¦åˆè¦æ±‚ (2-10)
            onlyChineseEnglish:
              type: boolean
              description: æ˜¯å¦åƒ…åŒ…å«ä¸­è‹±æ–‡
        errors:
          type: array
          description: å…·é«”éŒ¯èª¤è¨Šæ¯åˆ—è¡¨
          items:
            type: string
          example: ["åç¨±é•·åº¦è‡³å°‘éœ€è¦ 2 å€‹å­—å…ƒ", "åç¨±åƒ…å…è¨±ä¸­æ–‡å’Œè‹±æ–‡å­—æ¯"]

    LoginResponse:
      type: object
      properties:
        redirectUrl:
          type: string
          description: ç™»å…¥å¾Œå°å›è·¯å¾‘ï¼Œè‹¥ç¼ºçœå‰‡ç”±å‰ç«¯æ±ºå®šï¼ˆå¦‚é¦–é ï¼‰
        message:
          type: string
          description: ç™»å…¥è¨Šæ¯
          example: "ç™»å…¥æˆåŠŸ"
        token:
          type: string
          description: JWT Bearer Tokenï¼Œç”¨æ–¼å¾ŒçºŒ API èªè­‰
          example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        passwordExpiry:
          $ref: '#/components/schemas/PasswordExpiryInfo'

    PasswordExpiryInfo:
      type: object
      properties:
        isExpired:
          type: boolean
          description: å¯†ç¢¼æ˜¯å¦å·²éæœŸ
        isWarning:
          type: boolean
          description: æ˜¯å¦åœ¨è­¦å‘ŠæœŸå…§ï¼ˆ7å¤©å…§éæœŸï¼‰
        daysUntilExpiry:
          type: integer
          description: è·é›¢éæœŸå¤©æ•¸
        message:
          type: string
          description: äººé¡å¯è®€çš„ç‹€æ…‹è¨Šæ¯
          example: "æ‚¨çš„å¯†ç¢¼ç‹€æ…‹æ­£å¸¸ï¼Œè·é›¢éæœŸé‚„æœ‰ 180 å¤©ã€‚"

    PasswordResetResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        message:
          type: string
          description: å›æ‡‰è¨Šæ¯
          example: "å¯†ç¢¼é‡è¨­éƒµä»¶å·²ç™¼é€è‡³æ‚¨çš„éƒµç®±ï¼Œè«‹åœ¨ 24 å°æ™‚å…§å®Œæˆé‡è¨­"

    TokenVerificationResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        valid:
          type: boolean
          description: ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ
        email:
          type: string
          format: email
          description: ç”¨æˆ¶éƒµç®±åœ°å€ï¼ˆåƒ…åœ¨ä»¤ç‰Œæœ‰æ•ˆæ™‚æä¾›ï¼‰
        message:
          type: string
          description: å›æ‡‰è¨Šæ¯

    PasswordChangeResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        message:
          type: string
          description: å›æ‡‰è¨Šæ¯
          example: "å¯†ç¢¼æ›´æ–°æˆåŠŸ"
        passwordExpiry:
          $ref: '#/components/schemas/PasswordExpiryInfo'

    PasswordExpiryStatusResponse:
      type: object
      properties:
        success:
          type: boolean
          description: æ“ä½œæ˜¯å¦æˆåŠŸ
        isExpired:
          type: boolean
          description: å¯†ç¢¼æ˜¯å¦å·²éæœŸ
        isWarning:
          type: boolean
          description: æ˜¯å¦åœ¨è­¦å‘ŠæœŸå…§
        daysUntilExpiry:
          type: integer
          description: è·é›¢éæœŸå¤©æ•¸
        daysSinceChange:
          type: integer
          description: å¯†ç¢¼è®Šæ›´å¾Œç¶“éå¤©æ•¸
        lastChanged:
          type: string
          format: date-time
          description: å¯†ç¢¼æœ€å¾Œè®Šæ›´æ™‚é–“
        message:
          type: string
          description: äººé¡å¯è®€çš„ç‹€æ…‹è¨Šæ¯

security:
  - bearerAuth: []
  - cookieAuth: []



# 測試賽事資料使用說明

**更新日期**: 2025年10月22日  
**用途**: 提供前端測試預測功能的賽事資料

---

## 📋 快速開始

### 後端執行一次

```bash
cd /home/gogofire1774
chmod +x load-test-games.sh
./load-test-games.sh
```

執行後會自動載入 18 場測試賽事到資料庫。

### 前端直接查詢

前端不需要任何特殊配置，直接呼叫查詢 API 即可：

```bash
# 查詢所有賽事
curl -k https://10.2.0.2:8080/api/games

# 查詢未來賽事（可建立預測）
curl -k "https://10.2.0.2:8080/api/games?status=scheduled"

# 查詢特定運動
curl -k "https://10.2.0.2:8080/api/games?allianceId=1&status=scheduled"
```

---

## 🎯 測試資料內容

### 賽事總覽

| 運動類型 | 聯盟 | scheduled | live | finished | 總計 |
|---------|------|-----------|------|----------|------|
| 棒球 | MLB | 2 | 0 | 0 | 2 |
| 棒球 | NPB | 0 | 1 | 0 | 1 |
| 棒球 | CPBL | 0 | 0 | 2 | 2 |
| 棒球 | KBO | 1 | 0 | 0 | 1 |
| 籃球 | NBA | 2 | 1 | 0 | 3 |
| 籃球 | PLG | 0 | 0 | 2 | 2 |
| 籃球 | CBA | 1 | 0 | 0 | 1 |
| 足球 | Soccer | 1 | 0 | 1 | 2 |
| 冰球 | NHL | 1 | 0 | 1 | 2 |
| 美式足球 | NFL | 1 | 0 | 1 | 2 |
| **總計** | | **9** | **2** | **7** | **18** |

### 賽事狀態說明

- **scheduled** (9場): 未來 1-7 天的賽事，**可以建立預測**
- **live** (2場): 當天進行中的賽事，測試即時狀態顯示
- **finished** (7場): 過去 1-3 天已結束的賽事，**包含最終得分**

---

## 🏀 詳細賽事清單

### 棒球賽事

#### MLB - 美國職棒大聯盟

1. **洛杉磯道奇 vs 舊金山巨人**
   - 日期: 2025-10-25 19:05
   - 狀態: scheduled
   - 國際盤讓分: 主 -1.5 (1.85) / 客 +1.5 (1.95)
   - 大小分: 8.5 (O: 1.90 / U: 1.90)

2. **紐約洋基 vs 波士頓紅襪**
   - 日期: 2025-10-26 20:10
   - 狀態: scheduled
   - 國際盤讓分: 主 -2.5 (1.95) / 客 +2.5 (1.85)
   - 大小分: 9.5 (O: 1.88 / U: 1.92)

#### NPB - 日本職棒

3. **讀賣巨人 vs 阪神虎**
   - 日期: 2025-10-22 18:00
   - 狀態: live (進行中)
   - 國際盤讓分: 主 -1.0 (1.90) / 客 +1.0 (1.90)

#### CPBL - 中華職棒

4. **統一7-ELEVEn獅 vs 中信兄弟**
   - 日期: 2025-10-20 18:35
   - 狀態: finished
   - 最終比分: 8:5 (主隊勝)

5. **樂天桃猿 vs 富邦悍將**
   - 日期: 2025-10-21 18:35
   - 狀態: finished
   - 最終比分: 3:7 (客隊勝)

#### KBO - 韓國職棒

6. **起亞老虎 vs LG雙子**
   - 日期: 2025-10-27 18:00
   - 狀態: scheduled

### 籃球賽事

#### NBA

7. **洛杉磯湖人 vs 金州勇士**
   - 日期: 2025-10-24 19:30
   - 狀態: scheduled
   - 國際盤讓分: 主 -5.5 (1.90) / 客 +5.5 (1.90)
   - 大小分: 225.5

8. **波士頓塞爾提克 vs 邁阿密熱火**
   - 日期: 2025-10-25 20:00
   - 狀態: scheduled
   - 國際盤讓分: 主 -4.0 (1.88) / 客 +4.0 (1.92)

9. **鳳凰城太陽 vs 達拉斯獨行俠**
   - 日期: 2025-10-22 19:30
   - 狀態: live (進行中)

#### PLG - 台灣職籃

10. **新北國王 vs 台北富邦勇士**
    - 日期: 2025-10-19 19:00
    - 狀態: finished
    - 最終比分: 98:102

11. **桃園璞園領航猿 vs 高雄17直播鋼鐵人**
    - 日期: 2025-10-20 16:00
    - 狀態: finished
    - 最終比分: 89:85

#### CBA - 中國職籃

12. **廣東東莞大益 vs 遼寧本鋼**
    - 日期: 2025-10-28 19:35
    - 狀態: scheduled

### 足球賽事

13. **曼徹斯特城 vs 利物浦** (英超)
    - 日期: 2025-10-26 23:00
    - 狀態: scheduled
    - 國際盤讓分: 主 -0.5 (1.95) / 客 +0.5 (1.85)

14. **巴塞隆納 vs 皇家馬德里** (西甲)
    - 日期: 2025-10-21 03:00
    - 狀態: finished
    - 最終比分: 2:1

### 冰球賽事

15. **多倫多楓葉 vs 蒙特婁加拿大人** (NHL)
    - 日期: 2025-10-24 08:00
    - 狀態: scheduled

16. **波士頓棕熊 vs 紐約遊騎兵** (NHL)
    - 日期: 2025-10-20 08:30
    - 狀態: finished
    - 最終比分: 4:3

### 美式足球賽事

17. **堪薩斯城酋長 vs 舊金山49人** (NFL)
    - 日期: 2025-10-27 01:20
    - 狀態: scheduled

18. **達拉斯牛仔 vs 費城老鷹** (NFL)
    - 日期: 2025-10-21 09:00
    - 狀態: finished
    - 最終比分: 24:31

---

## 🧪 前端測試場景

### 場景 1: 查詢並顯示賽事列表

```bash
# 查詢所有未來賽事
curl -k "https://10.2.0.2:8080/api/games?status=scheduled"
```

**預期結果**: 返回 9 場未來賽事

### 場景 2: 查詢特定運動類型

```bash
# 查詢所有棒球賽事
curl -k "https://10.2.0.2:8080/api/games?allianceId=1"  # MLB
curl -k "https://10.2.0.2:8080/api/games?allianceId=3"  # NPB
curl -k "https://10.2.0.2:8080/api/games?allianceId=4"  # CPBL

# 查詢所有籃球賽事
curl -k "https://10.2.0.2:8080/api/games?allianceId=2"  # NBA
curl -k "https://10.2.0.2:8080/api/games?allianceId=97" # PLG
```

### 場景 3: 查詢特定日期

```bash
# 查詢 2025-10-25 的賽事
curl -k "https://10.2.0.2:8080/api/games?gameDate=2025-10-25"
```

### 場景 4: 建立預測（需登入）

選擇任一 scheduled 狀態的賽事，例如：

```bash
# 先登入獲取 cookie
curl -k -c cookies.txt -X POST https://10.2.0.2:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test1234!"}'

# 對 MLB 賽事建立預測
curl -k -b cookies.txt -X POST https://10.2.0.2:8080/api/predictions \
  -H "Content-Type: application/json" \
  -d '{
    "gameId": "20251025TEST001",
    "predictionType": "international_spread",
    "selection": "home",
    "odds": "1.85",
    "price": 100,
    "note": "主場優勢明顯"
  }'
```

### 場景 5: 查詢已結束賽事（含得分）

```bash
# 查詢已結束的賽事
curl -k "https://10.2.0.2:8080/api/games?status=finished"
```

**預期結果**: 返回 7 場已結束賽事，每場都包含 `finalScoreHome` 和 `finalScoreAway`

---

## 🔄 重新載入測試資料

如果需要重置測試資料：

```bash
# 重新執行載入腳本
./load-test-games.sh

# 腳本會自動：
# 1. 刪除舊的測試資料
# 2. 載入新的測試資料
# 3. 顯示載入統計
```

---

## 📊 聯盟 ID 對照表

前端查詢時需要的聯盟 ID：

| ID | 代碼 | 名稱 | 運動類型 |
|----|------|------|---------|
| 1 | MLB | 美國職棒大聯盟 | baseball |
| 2 | NBA | 美國職籃 | basketball |
| 3 | NPB | 日本職棒 | baseball |
| 4 | CPBL | 中華職棒 | baseball |
| 5 | SOCCER | 足球賽事 | soccer |
| 6 | KBO | 韓國職棒 | baseball |
| 12 | CBA | 中國職籃 | basketball |
| 91 | NHL | 國家冰球聯盟 | ice_hockey |
| 93 | NFL | 美國職業美式足球聯盟 | american_football |
| 97 | PLG | 台灣職籃 | basketball |

完整聯盟列表可透過 API 查詢：
```bash
curl -k https://10.2.0.2:8080/api/levels
```

---

## ❓ 常見問題

### Q1: 為什麼查詢結果是空的？

**A**: 請確認已執行載入腳本：
```bash
./load-test-games.sh
```

### Q2: 測試資料會影響正式環境嗎？

**A**: 不會。所有測試賽事的 ID 都包含 `TEST` 關鍵字，可以輕易識別和清理。

### Q3: 如何清除測試資料？

**A**: 執行以下 SQL：
```sql
DELETE FROM games WHERE id LIKE '2025%TEST%';
```

### Q4: 可以修改測試資料嗎？

**A**: 可以。直接編輯 `init-test-games.sql` 檔案，然後重新執行 `./load-test-games.sh`。

### Q5: scheduled 狀態的賽事為什麼不能建立預測？

**A**: 請確認：
1. 已登入（有 cookie 或 JWT token）
2. 賽事 ID 正確
3. 賽事狀態確實是 scheduled

### Q6: 如何驗證資料已正確載入？

**A**: 使用資料庫查詢：
```bash
psql postgresql://sgame_user:sgame_password@localhost:5432/sgame_db \
  -c "SELECT COUNT(*), status FROM games WHERE id LIKE '2025%TEST%' GROUP BY status;"
```

---

## 📞 需要幫助？

如果遇到任何問題：

1. 檢查載入日誌：`/tmp/load-test-games.log`
2. 查看資料庫連接狀態
3. 確認 API 服務正常運行
4. 參考其他測試文檔：
   - `後端API測試報告.md`
   - `最終測試報告.md`
   - `README-前端請先看這裡.md`

---

**最後更新**: 2025年10月22日  
**維護者**: 後端團隊

